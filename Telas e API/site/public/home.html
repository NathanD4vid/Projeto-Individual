<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="CSS/home.css">
    <link REL="SHORTCUT ICON" HREF="img/favicon.ico">
    <title>Home</title>
</head>
<body>

    <div class="banner">
        <div class="header">
            <div class="container">
                <div class="logos">
                    <div class="blizzard">
                        <img src="img/Blizzard-Logo.png" alt="">
                    </div>
                    <div class="over_logo">
                        <img src="img/logo.png" alt="" class="logoOver">
                        <img src="img/over2.png" alt="" class="escritaOver">
                    </div>
                    <div class="conteudos">
                        <a href="questionario.html">Desafio</a>
                        <a href="dashboard.html">Dashboard</a>
                    </div>  
                </div>  
                <ul>
                    <h3><span id="b_usuario">usuário</span></h3>
                    <li id="cadastroBotao"><a onclick="limparSessao()">Sair</a></li>    
                </ul>
            </div>
        </div>
    </div>
        
    <div class="inicio">
        <div class="container">
            <div class="owLeague">
                <h2>A Overwatch League</h2>
                <p>Após o sucesso estrondoso de Overwatch desde o seu lançamento, passando do número total de 35 milhões de jogadores, a Blizzard Entertainment passou a desenvolver a sua liga com alto investimento e uma proposta ousada. Similar às ligas profissionais americanas, cada equipe representa uma grande cidade, possui um dono, e seus atletas possuem salários regulares, benefícios e participação nas premiações.</p>
            </div>
            <div class="owLeagueBanner">
                <img src="img/owLeague.png" alt="">
            </div>
        </div>
    </div>
        
    <div class="classeJogo">
        <div class="container">
            <div class="campeaoTexto">
                <div class="tabela">
                    <h2>Os Campeões</h2>
                    <table>
                        <tr>
                            <th>Temporada</th>
                            <th id="champs">Time vencedor</th>
                            <th>Pontuação</th>
                            <th>Time perdedor</th>
                        </tr>
                        <tr>
                            <td>2018</td>
                            <td>London Spitfire</td>
                            <td>2 - 0</td>
                            <td>Philadelphia Fusion</td>
                        </tr>
                        <tr>
                            <td>2019</td>
                            <td>San Francisco Shock</td>
                            <td>4 - 0</td>
                            <td>Vancouver Titans</td>
                        </tr>
                        <tr>
                            <td>2020</td>
                            <td>San Francisco Shock</td>
                            <td>4 - 2</td>
                            <td>Seoul Dynasty</td>
                        </tr>
                        <tr>
                            <td>2021</td>
                            <td>Sanghai Dragons</td>
                            <td>4 - 0</td>
                            <td>Atlanta Reign</td>
                        </tr>
                        <tr>
                            <td>2022</td>
                            <td>Dallas Fuel</td>
                            <td>4 - 3</td>
                            <td>San Francisco Shock</td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="campeaoImagem">
                <div class="boxes">
                    <div class="box">
                        <img src="img/london.jpg" alt="">
                        <img src="img/san-francisco.jpg" alt="">
                    </div>
                    <div class="box2">
                        <img src="img/shanghai-dragons.jpg" alt="">
                        <img src="img/dallas.png" alt="">
                    </div>
                </div>
            </div>
        </div>    
    </div>

    <div class="premios">
        <div class="container">
            <div class="tituloQuestionario">
                <h3 id="titulinho">Nunca jogou Overwatch? Descubra uma classe para começar!</h3>
            </div>
            <div classe="questionario">

                <div class="quizHabilitar" style="display: none;">
                    <div class="quizMensagem">
                        <p>Esse quiz só pode ser realizado uma vez</p>
                        <p>Espero de coração que você tenha gostado de Overwatch</p>
                        <p>Ass: Nathan "Mega" David.</p>
                    </div>
                </div>

                <div class="perguntas1">
                    <div class="alternativas">
                        <label for="opcao">1) Qual a sua experiência com jogos FPS?</label>
                        <div>
                            <input id="dps" type="radio" name="opcao1" value="a"/> 3 Anos ou mais
                        </div>
                        <div>
                            <input id="tank" type="radio" name="opcao1" value="b"/> 1 Anos ou mais
                        </div>
                        <div>
                            <input id="sup" type="radio" name="opcao1" value="c"/> Menos de 1 ano
                        </div>
                        <div>
                            <input id="indeciso" type="radio" name="opcao1" value="d"/> Nenhuma experiência
                        </div>
                        <button onclick="registrar()">Próxima</button>
                    </div>
                </div>

                <div class="perguntas2" style="display: none;">
                    <div class="alternativas">
                        <label for="opcao2">2) Qual seu estilo de gameplay?</label>
                        <div>
                            <input id="dps2" type="radio" name="opcao2" value="a"/> Agressivo 
                        </div>
                        <div>
                            <input id="tank2" type="radio" name="opcao2" value="b"/> Meio a Meio
                        </div>
                        <div>
                            <input id="sup2" type="radio" name="opcao2" value="c"/> Passivo
                        </div>
                        <div>
                            <input id="indeciso2" type="radio" name="opcao2" value="d"/> Não faço ideia
                        </div>
                        <button onclick="registrar()">Próxima</button>
                    </div>
                </div>

                <div class="perguntas3" style="display: none;">
                    <div class="alternativas">
                        <label for="opcao3">3) Qual tipo de jogo abaixo você prefere?</label>
                        <div>
                            <input id="dps3" type="radio" name="opcao3" value="a"/> FPS
                        </div>
                        <div>
                            <input id="tank3" type="radio" name="opcao3" value="b"/> RPG
                        </div>
                        <div>
                            <input id="sup3" type="radio" name="opcao3" value="c"/> História/Aventura
                        </div>
                        <div>
                            <input id="indeciso3" type="radio" name="opcao3" value="d"/> Não sei
                        </div>
                        <button onclick="registrar()">Próxima</button>
                    </div>
                </div>

                <div class="perguntas4" style="display: none;">
                    <div class="alternativas">
                        <label for="opcao4">4) Qual tipo de mobilidade você prefere?</label>
                        <div>
                            <input id="dps4" type="radio" name="opcao4"  value="a"/> Rápida
                        </div>
                        <div>
                            <input id="tank4" type="radio" name="opcao4" value="b"/> Balanceada
                        </div>
                        <div>
                            <input id="sup4" type="radio" name="opcao4" value="c"/> Calma
                        </div>
                        <div>
                            <input id="indeciso4" type="radio" name="opcao4" value="d"/> Não sei ao certo
                        </div>
                        <button onclick="registrar()">Próxima</button>
                    </div>
                </div>

                <div class="perguntas5" style="display: none;">
                    <div class="alternativas">
                        <label for="opcao5">5) Você é uma pessoa</label>
                        <div>
                            <input id="dps5" type="radio" name="opcao5" value="a"/> Sem paciência
                        </div>
                        <div>
                            <input id="tank5" type="radio" name="opcao5" value="b"/> Balanceada
                        </div>
                        <div>
                            <input id="sup5" type="radio" name="opcao5" value="c"/> Paciente
                        </div>
                        <button onclick="registrar()">Próxima</button>
                    </div>
                </div>

                <div id="parabens" style="display: none;">
                    <div class="salve">
                            <p id="nome_classes"></p>
                            <img id="img_classes" src="" alt="">
                    </div>
                </div>

            </div>
        </div>
    </div>
        
    <div class="footer">
        <div class="container">
            <span>&copy 2000 e Sempre -- Nathan David</span>
        </div>
    </div>
</body>

</html>

<script>
    b_usuario.innerHTML = sessionStorage.NOME_USUARIO;
    
    var index = 1

    var dps = 0
    var tank = 0
    var cura = 0
    var indeciso = 0

    var habilitarQuiz = sessionStorage.QUIZ_USUARIO
    
    if (habilitarQuiz != "false") {
        document.querySelector(`.perguntas1`).style.display = "none";
        document.querySelector(`.quizHabilitar`).style.display = "block";
    }
    
    var i = 1

    function registrar() {
        for (; i <= 5; i++) {
            var resposta = document.querySelector(`input[name="opcao${i}"]:checked`).value

            if (resposta == 'a') {
                dps++
            } else if (resposta == 'b') {
                tank++
            } else if (resposta == 'c') {
                cura++
            } else {
                indeciso++
            }

            mudar()
            break
        }
        i++
    }
    
   
    var classe = 0;

    function mudar() {
        for (;index <= 5;) {
            var question = document.querySelector(`.perguntas${index}`) ;
            question.style.display = "none";
            break;
        }

        index++
        if (index <= 5) {
            document.querySelector(`.perguntas${index}`).style.display = "block";
        } else {
            titulinho.innerHTML = `De acordo com sua experiencia recomendamos para você:`
            document.querySelector(`#parabens`).style.display = "block";

            if (dps >= 3) {
                nome_classes.innerHTML = `DANO`;
                img_classes.src = 'img/danos.png';
                classe = `dano`;
                cadastrarClasse()
            } else if (tank >= 3) {
                nome_classes.innerHTML = `TANQUE`;
                img_classes.src = 'img/tanks.png';
                classe = `tanque`;
                cadastrarClasse()
            } else if (cura >= 3) {
                nome_classes.innerHTML = `SUPORTE`;
                img_classes.src = 'img/curas.png';
                classe = `suporte`;
                cadastrarClasse()
            } else if (indeciso >= 3) {
                nome_classes.innerHTML = `SUPORTE`;
                img_classes.src = 'img/curas.png';
                classe = `suporte`;
                cadastrarClasse()
            } else if ( dps == tank ) {
                nome_classes.innerHTML = `TANQUE`;
                img_classes.src = 'img/tanks.png';
                classe = `tanque`;
                cadastrarClasse()
            } else if (dps == cura) {
                nome_classes.innerHTML = `SUPORTE`;
                img_classes.src = 'img/curas.png';
                classe = `suporte`;
                cadastrarClasse()
            } else if (tank == cura) {
                nome_classes.innerHTML = `SUPORTE`;
                img_classes.src = 'img/curas.png';
                classe = `suporte`;
                cadastrarClasse()
            }
        }
    }

    function cadastrarClasse() {
        sessionStorage.QUIZ_USUARIO = "true"

        var classeVar = classe;
        var idVar = sessionStorage.ID_USUARIO;

        if (classeVar == "" || idVar == "") {
            alert("Erro no questionario");

            return false;
        }

        fetch("/quiz/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({

                classeServer: classeVar,
                idServer: idVar
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                atualizarUsuario()

            } else {
                throw ("Houve um erro ao tentar enviar ao banco");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });
        return false;
    }

    function atualizarUsuario() {
        var idVar2 = sessionStorage.ID_USUARIO;

        if (idVar2 == "") {
            alert("Erro no questionario");

            return false;
        }

        fetch("/atualizar/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                
                idServer2: idVar2
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                alert('Agora foi')

            } else {
                throw ("Houve um erro ao tentar enviar ao banco");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });
        return false;
    }
</script>