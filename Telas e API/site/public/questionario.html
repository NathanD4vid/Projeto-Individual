<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="CSS/questionario.css">
    <link REL="SHORTCUT ICON" HREF="img/favicon.ico">
    <script src="js/funcoes.js"></script>
    <title>Questionário</title>
</head>

<body>

    <div class="banner">
        <div class="header">
            <div class="container">
                <div class="logos">
                    <div class="blizzard">
                        <img src="img/Blizzard-Logo.png" alt="">
                    </div>
                    <div class="over_logo">
                        <img src="img/logo.png" alt="" class="logoOver">
                        <img src="img/over2.png" alt="" class="escritaOver">
                    </div>
                    <div class="conteudos">
                        <a class="navegacao" href="home.html">Home</a>
                        <a class="navegacao" href="dashboard.html">Dashboard</a>
                    </div>
                </div>
                <ul>
                    <h3><span id="b_usuario">usuário</span></h3>
                    <span id="b_elo"></span>
                    <li id="cadastroBotao" onclick="limparSessao()"><a onclick="limparSessao()">Sair</a></li>
                </ul>
            </div>
        </div>

        <div class="premios">
            <div class="container">
                <div class="tituloQuestionario">
                    <h2 id="titulinho">Preparado para um desafio?</h2>
                </div>

                <div class="questionario">

                    <div class="pergunta1" style="display: block;">
                        <div class="alternativas">
                            <label> Qual o personagem de nacionalidade brasileira de Overwatch?</label>
                            <div>
                                <input type="radio" name="opcao1" value="0" /> <span>Soldado 76</span> 
                            </div>
                            <div>
                                <input type="radio" name="opcao1" value="correta" /> Lucio
                            </div>
                            <div>
                                <input type="radio" name="opcao1" value="0" /> Winston
                            </div>
                            <div>
                                <input type="radio" name="opcao1" value="0" /> Ana
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta2" style="display: none;">
                        <div class="alternativas">
                            <label> Qual mapa se passa no Brasil?</label>
                            <div>
                                <input type="radio" name="opcao2" value="0" /> Rota 66
                            </div>
                            <div>
                                <input type="radio" name="opcao2" value="0" /> Busan
                            </div>
                            <div>
                                <input type="radio" name="opcao2" value="correta" /> Paraíso
                            </div>
                            <div>
                                <input type="radio" name="opcao2" value="0" /> Kings Row
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta3" style="display: none;">
                        <div class="alternativas">
                            <label> Qual personagem é irmão do Genji?</label>
                            <div>
                                <input type="radio" name="opcao3" value="correta" /> Hanzo
                            </div>
                            <div>
                                <input type="radio" name="opcao3" value="0" /> Bastion
                            </div>
                            <div>
                                <input type="radio" name="opcao3" value="0" /> Orisa
                            </div>
                            <div>
                                <input type="radio" name="opcao3" value="0" /> Moira
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta4" style="display: none;">
                        <div class="alternativas">
                            <label> Quando overwatch ganhou o Game Of The Year?</label>
                            <div>
                                <input type="radio" name="opcao4" value="0" /> 2020
                            </div>
                            <div>
                                <input type="radio" name="opcao4" value="0" /> 2018
                            </div>
                            <div>
                                <input type="radio" name="opcao4" value="correta" /> 2016
                            </div>
                            <div>
                                <input type="radio" name="opcao4" value="0" /> Nunca ganhou
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta5" style="display: none;">
                        <div class="alternativas">
                            <label> Qual a organização inimiga da Overwatch?</label>
                            <div>
                                <input type="radio" name="opcao5" value="correta" /> Talon
                            </div>
                            <div>
                                <input type="radio" name="opcao5" value="0" /> Blackwatch
                            </div>
                            <div>
                                <input type="radio" name="opcao5" value="0" /> Gangue Deadlock
                            </div>
                            <div>
                                <input type="radio" name="opcao5" value="0" /> Clã Shimada
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta6" style="display: none;">
                        <div class="alternativas">
                            <label> O que a d.va fala depois que ela utiliza sua ultimate?</label>
                            <div>
                                <input type="radio" name="opcao6" value="0" /> "La vaiii"
                            </div>
                            <div>
                                <input type="radio" name="opcao6" value="correta" /> "Pede pra nerfar noob"
                            </div>
                            <div>
                                <input type="radio" name="opcao6" value="0" /> "Desculpe"
                            </div>
                            <div>
                                <input type="radio" name="opcao6" value="0" /> "Nathan Muito Gato"
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta7" style="display: none;">
                        <div class="alternativas">
                            <label> Qual evento levou a criação da Overwatch?</label>
                            <div>
                                <input type="radio" name="opcao7" value="0" /> Ataque Alienigêna
                            </div>
                            <div>
                                <input type="radio" name="opcao7" value="0" /> Aquecimento Global
                            </div>
                            <div>
                                <input type="radio" name="opcao7" value="0" /> Ataque do Thanos
                            </div>
                            <div>
                                <input type="radio" name="opcao7" value="correta" /> A Crise Ôminica
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta8" style="display: none;">
                        <div class="alternativas">
                            <label> Qual personagem tem uma ultimate que te deixa preso em um buraco
                                negro?</label>
                            <div>
                                <input type="radio" name="opcao8" value="correta" /> Zarya
                            </div>
                            <div>
                                <input type="radio" name="opcao8" value="0" /> Sigma
                            </div>
                            <div>
                                <input type="radio" name="opcao8" value="0" /> Orisa
                            </div>
                            <div>
                                <input type="radio" name="opcao8" value="0" /> RoadHog
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta9" style="display: none;">
                        <div class="alternativas">
                            <label> Como se chama o combo das habilidades ultimate da Ana e do Genji?</label>
                            <div>
                                <input type="radio" name="opcao9" value="0" /> SabreTurbo
                            </div>
                            <div>
                                <input type="radio" name="opcao9" value="0" /> SwordDragon
                            </div>
                            <div>
                                <input type="radio" name="opcao9" value="correta" /> NanoBlade
                            </div>
                            <div>
                                <input type="radio" name="opcao9" value="0" /> GenjiAmari
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta10" style="display: none;">
                        <div class="alternativas">
                            <label> Qual o elo máximo do Overwatch</label>
                            <div>
                                <input type="radio" name="opcao10" value="correta" /> Top 500
                            </div>
                            <div>
                                <input type="radio" name="opcao10" value="0" /> Global
                            </div>
                            <div>
                                <input type="radio" name="opcao10" value="0" /> Grão-Mestre
                            </div>
                            <div>
                                <input type="radio" name="opcao10" value="0" /> Radiante
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta11" style="display: none;">
                        <div class="alternativas">
                            <label> Qual o elo mínimo em Overwatch?</label>
                            <div>
                                <input type="radio" name="opcao11" value="0" /> Recruta
                            </div>
                            <div>
                                <input type="radio" name="opcao11" value="0" /> Latão
                            </div>
                            <div>
                                <input type="radio" name="opcao11" value="0" /> Ferro
                            </div>
                            <div>
                                <input type="radio" name="opcao11" value="correta" /> Bronze
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta12" style="display: none;">
                        <div class="alternativas">
                            <label> Quais são os tipos de mapa disponíveis na rankeada?</label>
                            <div>
                                <input type="radio" name="opcao12" value="correta" /> Híbrido, Escolta, Controle e
                                Avanço
                            </div>
                            <div>
                                <input type="radio" name="opcao12" value="0" /> Híbrido, Escolta, Avanço e Pegue a
                                Bandeira
                            </div>
                            <div>
                                <input type="radio" name="opcao12" value="0" /> Escolta, Avanço, Pegue a Bandeira e
                                Corrida
                            </div>
                            <div>
                                <input type="radio" name="opcao12" value="0" /> Escolta, Controle, Avanço e Vingança de
                                Junkstein
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta13" style="display: none;">
                        <div class="alternativas">
                            <label> A personagem Phara tem uma mãe membra da Overwatch. Quem é ela?</label>
                            <div>
                                <input type="radio" name="opcao13" value="correta" /> Ana Amari
                            </div>
                            <div>
                                <input type="radio" name="opcao13" value="0" /> Brigitte Lindholm
                            </div>
                            <div>
                                <input type="radio" name="opcao13" value="0" /> Doutora Angela Ziegler
                            </div>
                            <div>
                                <input type="radio" name="opcao13" value="0" /> Aleksandra Zaryanova
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta14" style="display: none;">
                        <div class="alternativas">
                            <label> Qual personagem é um(a) hacker profissional?</label>
                            <div>
                                <input type="radio" name="opcao14" value="0" /> Tracer
                            </div>
                            <div>
                                <input type="radio" name="opcao14" value="0" /> Zarya
                            </div>
                            <div>
                                <input type="radio" name="opcao14" value="correta" /> Sombra
                            </div>
                            <div>
                                <input type="radio" name="opcao14" value="0" /> Nenhuma das opções acima
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta15" style="display: none;">
                        <div class="alternativas">
                            <label> Qual personagem teletransporta no tempo?</label>
                            <div>
                                <input type="radio" name="opcao15" value="0" /> Junkrat
                            </div>
                            <div>
                                <input type="radio" name="opcao15" value="correta" /> Tracer
                            </div>
                            <div>
                                <input type="radio" name="opcao15" value="0" /> Baptiste
                            </div>
                            <div>
                                <input type="radio" name="opcao15" value="0" /> Doomfist
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta16" style="display: none;">
                        <div class="alternativas">
                            <label> Qual personagem de overwatch lhe deixa congelado?</label>
                            <div>
                                <input type="radio" name="opcao16" value="correta" /> Mei
                            </div>
                            <div>
                                <input type="radio" name="opcao16" value="0" /> Soujourn
                            </div>
                            <div>
                                <input type="radio" name="opcao16" value="0" /> Rainha Junker
                            </div>
                            <div>
                                <input type="radio" name="opcao16" value="0" /> Pharah
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta17" style="display: none;">
                        <div class="alternativas">
                            <label> Quais personagens de Overwatch voam?</label>
                            <div>
                                <input type="radio" name="opcao17" value="0" /> Winston e Tracer
                            </div>
                            <div>
                                <input type="radio" name="opcao17" value="0" /> Reaper e Widowmaker
                            </div>
                            <div>
                                <input type="radio" name="opcao17" value="correta" /> Phara e Echo
                            </div>
                            <div>
                                <input type="radio" name="opcao17" value="0" /> Symmetra e Sigma
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta18" style="display: none;">
                        <div class="alternativas">
                            <label> Qual personagem se assemelha a uma bola?</label>
                            <div>
                                <input type="radio" name="opcao18" value="0" /> Bastion
                            </div>
                            <div>
                                <input type="radio" name="opcao18" value="0" /> Roadhog
                            </div>
                            <div>
                                <input type="radio" name="opcao18" value="0" /> DVA
                            </div>
                            <div>
                                <input type="radio" name="opcao18" value="correta" /> Hammond
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta19" style="display: none;">
                        <div class="alternativas">
                            <label> Qual personagem é um engenheiro?</label>
                            <div>
                                <input type="radio" name="opcao19" value="0" /> Moira
                            </div>
                            <div>
                                <input type="radio" name="opcao19" value="0" /> Doomfist
                            </div>
                            <div>
                                <input type="radio" name="opcao19" value="0" /> Reinhardt
                            </div>
                            <div>
                                <input type="radio" name="opcao19" value="correta" /> Tobjorn
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div class="pergunta20" style="display: none;">
                        <div class="alternativas">
                            <label> Quem fala "Ryūjin no ken wo kūrae!"</label>
                            <div>
                                <input type="radio" name="opcao20" value="0" /> Ashe
                            </div>
                            <div>
                                <input type="radio" name="opcao20" value="correta" /> Genji
                            </div>
                            <div>
                                <input type="radio" name="opcao20" value="0" /> Cassidy
                            </div>
                            <div>
                                <input type="radio" name="opcao20" value="0" /> Hanzo
                            </div>
                            <button onclick="mudar()">Próxima</button>
                        </div>
                    </div>

                    <div id="parabens" style="display: none;">
                        <div class="salve">
                            <span id="acertosTotal"></span>
                            <div id="box">
                                <span id="span_msg"></span>
                                <span id="eloTotal"></span>
                                <span id="nomeElo"></span>
                            </div>
                            <p>Para conferir o nosso top 5 acesse o nosso <a id="dashLink" href="dashboard.html">Dashboard</a></p>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <div class="container">
            <span>&copy 2000 e Sempre -- Nathan David</span>
        </div>
    </div>
</body>

</html>

<script>
    b_usuario.innerHTML = sessionStorage.NOME_USUARIO
    b_elo.innerHTML = `<img src="${sessionStorage.ELO_USUARIO}" alt="" id="elozinho">`

    var acertos = 0;
    var cont = 1;
    var index = 1;
    var vt_repeticao = [];
    var elo = 0;
    var eloNome = 0;


    function mudar() {
        if (cont == 1) {
            vt_repeticao.push(cont)
        }

        var numero = Number((Math.random() * 19 + 1).toFixed(0));

        if (cont < 20) {
            while (vt_repeticao.indexOf(numero) != -1) {
                numero = Number((Math.random() * 19 + 1).toFixed(0));
            }
        }


        for (; cont <= 20;) {
            var question = document.querySelector(`.pergunta${index}`);

            var resposta = document.querySelector(`input[name="opcao${index}"]:checked`).value

            if (resposta == "correta") {
                acertos++
            }

            question.style.display = "none";
            cont++
            break;
        }

        index = Number(numero)

        vt_repeticao.push(index)

        if (cont <= 20) {
            document.querySelector(`.pergunta${index}`).style.display = "block";
        } else {

            if (acertos <= 4) {
                elo = "img/elos/bronze.png"
                eloNome = "Bronze"
            } else if (acertos <= 7) {
                elo = "img/elos/silver.png"
                eloNome = "Prata"
            } else if (acertos <= 10) {
                elo = "img/elos/gold.png"
                eloNome = "Ouro"
            } else if (acertos <= 12) {
                elo = "img/elos/platinum.png"
                eloNome = "Platina"
            } else if (acertos <= 14) {
                elo = "img/elos/diamante.png"
                eloNome = "Diamante"
            } else if (acertos <= 16) {
                elo = "img/elos/master.png"
                eloNome = "Mestre"
            } else if (acertos <= 18) {
                elo = "img/elos/grao.png"
                eloNome = "Grão-Mestre"
            } else {
                elo = "img/elos/top500.png"
                eloNome = "Top-500"
            } 

            titulinho.innerHTML = `Você acertou um total de:`
            acertosTotal.innerHTML = `${acertos} de 20`
            document.querySelector(`#parabens`).style.display = "flex";
            span_msg.innerHTML = `Seu novo elo é:`;
            eloTotal.innerHTML = `<img src="${elo}" alt="" id="elozinho2">`;
            nomeElo.innerHTML = `${eloNome}`;

            cadastrarResposta()
        }
    }

    function cadastrarResposta() {
        sessionStorage.ELO_USUARIO = elo;

        var acertosVar = acertos;
        var idVar = sessionStorage.ID_USUARIO;

        if (acertosVar == 0) {
            acertosVar = "0"
        }
        
        if (acertosVar == "" || idVar == "") {
            alert("Erro no questionario");
            return false;
        }

        if (acertosVar == "0") {
            acertosVar = 0
        }

        fetch("/desafio/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                acertosServer: acertosVar,
                idServer: idVar,
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                alert('Resposta enviada ao banco')
                 
                atualizarElo();
            } else {
                throw ("Houve um erro ao tentar enviar ao banco");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });
        return false;
    }

    function atualizarElo() {
        var eloVar = elo;
        var idVar = sessionStorage.ID_USUARIO;

        if (eloVar == "" || idVar == "") {
            console.log("Erro no questionario");

            return false;
        }

        fetch("/atualizar/elo", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                eloServer: eloVar,
                idServer3: idVar
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {
                console.log('Elo enviado ao banco')

            } else {
                throw ("Houve um erro ao tentar enviar ao banco");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });
        return false;
    }
</script>